<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Learning App - FULL VERSION WITH ALL FEATURES</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .chess-square {
            width: 12.5%;
            height: 12.5%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
        }
        .chess-piece {
            font-size: 2rem;
            font-weight: bold;
            user-select: none;
        }
        .valid-move {
            position: absolute;
            width: 20px;
            height: 20px;
            background: green;
            border-radius: 50%;
            opacity: 0.8;
        }
        @media (max-width: 640px) {
            .chess-piece {
                font-size: 1.5rem;
            }
            .valid-move {
                width: 15px;
                height: 15px;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-orange-100 p-2 sm:p-4">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-4 sm:mb-6">
            <h1 class="text-2xl sm:text-3xl font-bold text-amber-900 mb-2">Chess Game</h1>
            <p id="gameStatus" class="text-base sm:text-lg text-amber-700">White to move</p>
        </div>

        <!-- Main Game Container -->
        <div class="flex flex-col lg:flex-row gap-4 sm:gap-6 items-start justify-center">
            
            <!-- Board Section -->
            <div class="flex-1 flex flex-col items-center justify-center min-w-0">
                
                <!-- Top Timer - Mobile/Tablet -->
                <div class="flex justify-center mb-2 sm:mb-3 lg:hidden">
                    <div class="flex flex-col items-center bg-gray-100 p-2 sm:p-3 rounded-lg min-w-[80px] sm:min-w-[100px]">
                        <div class="text-xs sm:text-sm font-semibold text-gray-700">White Time</div>
                        <div id="whiteTime" class="text-sm sm:text-lg font-bold text-gray-900">10:00</div>
                    </div>
                </div>

                <!-- Board Container -->
                <div class="w-full max-w-[280px] sm:max-w-[320px] md:max-w-[360px] lg:max-w-[400px] xl:max-w-[450px]">
                    <div id="chessBoard" class="w-full aspect-square border-2 sm:border-3 lg:border-4 border-gray-800 bg-gray-900 p-1 sm:p-2 lg:p-3 rounded-lg shadow-2xl">
                        <!-- Board will be generated by JavaScript -->
                    </div>
                </div>

                <!-- Bottom Timer - Mobile/Tablet -->
                <div class="flex justify-center mt-2 sm:mt-3 lg:hidden">
                    <div class="flex flex-col items-center bg-gray-100 p-2 sm:p-3 rounded-lg min-w-[80px] sm:min-w-[100px]">
                        <div class="text-xs sm:text-sm font-semibold text-gray-700">Black Time</div>
                        <div id="blackTime" class="text-sm sm:text-lg font-bold text-gray-900">10:00</div>
                    </div>
                </div>

                <!-- Side Timers - Desktop -->
                <div class="hidden lg:flex items-center gap-3 w-full max-w-[500px] mx-auto mt-4">
                    <div class="flex flex-col items-center bg-gray-100 p-3 rounded-lg min-w-[100px]">
                        <div class="text-sm font-semibold text-gray-700">White Time</div>
                        <div id="whiteTimeDesktop" class="text-lg font-bold text-gray-900">10:00</div>
                    </div>
                    <div class="flex-1"></div>
                    <div class="flex flex-col items-center bg-gray-100 p-3 rounded-lg min-w-[100px]">
                        <div class="text-sm font-semibold text-gray-700">Black Time</div>
                        <div id="blackTimeDesktop" class="text-lg font-bold text-gray-900">10:00</div>
                    </div>
                </div>

                <!-- Timer Controls -->
                <div class="mt-4 flex justify-center gap-2 flex-wrap">
                    <button onclick="startTimer()" class="px-3 py-1 sm:px-4 sm:py-2 bg-green-600 text-white rounded hover:bg-green-700 text-xs sm:text-sm">
                        Start
                    </button>
                    <button onclick="pauseTimer()" class="px-3 py-1 sm:px-4 sm:py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 text-xs sm:text-sm">
                        Pause
                    </button>
                    <button onclick="resetTimer()" class="px-3 py-1 sm:px-4 sm:py-2 bg-red-600 text-white rounded hover:bg-red-700 text-xs sm:text-sm">
                        Reset
                    </button>
                </div>

            </div>

            <!-- Control Panel - Desktop (Right Side) -->
            <div class="w-full lg:w-80 space-y-3 sm:space-y-4">
                
                <!-- Game Controls -->
                <div class="bg-white p-4 rounded-lg shadow-md">
                    <h3 class="text-lg font-bold mb-3 text-gray-800">Game Controls</h3>
                    <div class="space-y-2">
                        <button onclick="resetBoard()" class="w-full px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm">
                            New Game
                        </button>
                        <button onclick="flipBoard()" class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm">
                            Flip Board
                        </button>
                        <button onclick="goBackToLobby()" class="w-full px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm">
                            Back to Lobby
                        </button>
                    </div>
                </div>

                <!-- Game Status -->
                <div class="bg-white p-4 rounded-lg shadow-md">
                    <h3 class="text-lg font-bold mb-3 text-gray-800">Game Status</h3>
                    <p id="gameStatusCard" class="text-sm sm:text-base font-semibold text-gray-700">White to move</p>
                </div>

                <!-- Time Control -->
                <div class="bg-white p-4 rounded-lg shadow-md">
                    <h3 class="text-lg font-bold mb-3 text-gray-800">Time Control</h3>
                    <div class="space-y-2">
                        <button onclick="setTimeControl(1)" class="w-full px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">1 min</button>
                        <button onclick="setTimeControl(3)" class="w-full px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">3 min</button>
                        <button onclick="setTimeControl(5)" class="w-full px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">5 min</button>
                        <button onclick="setTimeControl(10)" class="w-full px-3 py-1 bg-blue-200 text-blue-800 rounded hover:bg-blue-300 text-sm font-semibold">10 min</button>
                        <button onclick="setTimeControl(15)" class="w-full px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">15 min</button>
                        <button onclick="setTimeControl(30)" class="w-full px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">30 min</button>
                    </div>
                </div>

                <!-- Theme Selection -->
                <div class="bg-white p-4 rounded-lg shadow-md">
                    <h3 class="text-lg font-bold mb-3 text-gray-800">Board Theme</h3>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="setTheme('classic')" class="px-3 py-2 bg-amber-200 text-amber-800 rounded hover:bg-amber-300 text-sm font-semibold">Classic</button>
                        <button onclick="setTheme('wood')" class="px-3 py-2 bg-amber-100 text-amber-800 rounded hover:bg-amber-200 text-sm">Wood</button>
                        <button onclick="setTheme('pink')" class="px-3 py-2 bg-pink-100 text-pink-800 rounded hover:bg-pink-200 text-sm">Pink</button>
                        <button onclick="setTheme('modern')" class="px-3 py-2 bg-gray-100 text-gray-800 rounded hover:bg-gray-200 text-sm">Modern</button>
                        <button onclick="setTheme('blue')" class="px-3 py-2 bg-blue-100 text-blue-800 rounded hover:bg-blue-200 text-sm">Blue</button>
                    </div>
                </div>

                <!-- Sound Controls -->
                <div class="bg-white p-4 rounded-lg shadow-md">
                    <h3 class="text-lg font-bold mb-3 text-gray-800">Sound</h3>
                    <div class="space-y-2">
                        <button onclick="toggleSound()" id="soundToggle" class="w-full px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm">
                            Sound: ON
                        </button>
                        <button onclick="playMoveSound()" class="w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm">
                            Test Sound
                        </button>
                    </div>
                </div>

            </div>

        </div>

        <!-- Mobile Control Panel - Hidden on Desktop -->
        <div class="lg:hidden mt-6 space-y-3">
            
            <!-- Game Controls - Mobile -->
            <div class="bg-white p-4 rounded-lg shadow-md">
                <h3 class="text-lg font-bold mb-3 text-gray-800">Game Controls</h3>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="resetBoard()" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm">
                        New Game
                    </button>
                    <button onclick="flipBoard()" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm">
                        Flip Board
                    </button>
                    <button onclick="goBackToLobby()" class="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm">
                        Back to Lobby
                    </button>
                </div>
            </div>

            <!-- Game Status - Mobile -->
            <div class="bg-white p-4 rounded-lg shadow-md">
                <h3 class="text-lg font-bold mb-3 text-gray-800">Game Status</h3>
                <p id="gameStatusMobile" class="text-sm sm:text-base font-semibold text-gray-700">White to move</p>
            </div>

            <!-- Time Control - Mobile -->
            <div class="bg-white p-4 rounded-lg shadow-md">
                <h3 class="text-lg font-bold mb-3 text-gray-800">Time Control</h3>
                <div class="grid grid-cols-3 gap-2">
                    <button onclick="setTimeControl(1)" class="px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">1 min</button>
                    <button onclick="setTimeControl(3)" class="px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">3 min</button>
                    <button onclick="setTimeControl(5)" class="px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">5 min</button>
                    <button onclick="setTimeControl(10)" class="px-3 py-1 bg-blue-200 text-blue-800 rounded hover:bg-blue-300 text-sm font-semibold">10 min</button>
                    <button onclick="setTimeControl(15)" class="px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">15 min</button>
                    <button onclick="setTimeControl(30)" class="px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-sm">30 min</button>
                </div>
            </div>

            <!-- Theme Selection - Mobile -->
            <div class="bg-white p-4 rounded-lg shadow-md">
                <h3 class="text-lg font-bold mb-3 text-gray-800">Board Theme</h3>
                <div class="grid grid-cols-3 gap-2">
                    <button onclick="setTheme('classic')" class="px-3 py-2 bg-amber-200 text-amber-800 rounded hover:bg-amber-300 text-sm font-semibold">Classic</button>
                    <button onclick="setTheme('wood')" class="px-3 py-2 bg-amber-100 text-amber-800 rounded hover:bg-amber-200 text-sm">Wood</button>
                    <button onclick="setTheme('pink')" class="px-3 py-2 bg-pink-100 text-pink-800 rounded hover:bg-pink-200 text-sm">Pink</button>
                    <button onclick="setTheme('modern')" class="px-3 py-2 bg-gray-100 text-gray-800 rounded hover:bg-gray-200 text-sm">Modern</button>
                    <button onclick="setTheme('blue')" class="px-3 py-2 bg-blue-100 text-blue-800 rounded hover:bg-blue-200 text-sm">Blue</button>
                </div>
            </div>

            <!-- Sound Controls - Mobile -->
            <div class="bg-white p-4 rounded-lg shadow-md">
                <h3 class="text-lg font-bold mb-3 text-gray-800">Sound</h3>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="toggleSound()" id="soundToggleMobile" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm">
                        Sound: ON
                    </button>
                    <button onclick="playMoveSound()" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm">
                        Test Sound
                    </button>
                </div>
            </div>

        </div>

        <!-- Promotion Dialog -->
        <div id="promotionDialog" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 hidden">
            <div class="bg-white p-6 rounded-lg max-w-sm w-full">
                <h3 class="text-lg font-bold mb-4 text-center">Choose Promotion Piece</h3>
                <div class="grid grid-cols-4 gap-2">
                    <button onclick="promotePiece('queen')" class="aspect-square text-2xl border rounded hover:bg-gray-100">♕</button>
                    <button onclick="promotePiece('rook')" class="aspect-square text-2xl border rounded hover:bg-gray-100">♖</button>
                    <button onclick="promotePiece('bishop')" class="aspect-square text-2xl border rounded hover:bg-gray-100">♗</button>
                    <button onclick="promotePiece('knight')" class="aspect-square text-2xl border rounded hover:bg-gray-100">♘</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Chess game logic
        const PIECE_SYMBOLS = {
            white: { pawn: "♙", rook: "♖", knight: "♘", bishop: "♗", queen: "♕", king: "♔" },
            black: { pawn: "♟", rook: "♜", knight: "♞", bishop: "♝", queen: "♛", king: "♚" }
        };

        let board = [];
        let selectedSquare = null;
        let validMoves = [];
        let currentPlayer = 'white';
        let isFlipped = false;
        let promotionSquare = null;
        
        // Timer variables
        let whiteTime = 600; // 10 minutes in seconds
        let blackTime = 600;
        let isTimerRunning = false;
        let timerInterval = null;
        let timeControl = 10; // default 10 minutes

        // Theme variables
        let currentTheme = 'classic';
        const themes = {
            classic: { light: '#fef3c7', dark: '#92400e' },
            wood: { light: '#d4a574', dark: '#8b4513' },
            pink: { light: '#fce7f3', dark: '#ec4899' },
            modern: { light: '#e5e7eb', dark: '#374151' },
            blue: { light: '#dbeafe', dark: '#1e40af' }
        };

        // Sound variables
        let soundEnabled = true;
        let audioContext = null;

        function createInitialBoard() {
            const board = Array(8).fill(null).map(() => Array(8).fill(null));
            
            // White pieces
            board[7] = [
                { type: "rook", color: "white" },
                { type: "knight", color: "white" },
                { type: "bishop", color: "white" },
                { type: "queen", color: "white" },
                { type: "king", color: "white" },
                { type: "bishop", color: "white" },
                { type: "knight", color: "white" },
                { type: "rook", color: "white" }
            ];
            for (let i = 0; i < 8; i++) board[6][i] = { type: "pawn", color: "white" };

            // Black pieces
            board[0] = [
                { type: "rook", color: "black" },
                { type: "knight", color: "black" },
                { type: "bishop", color: "black" },
                { type: "queen", color: "black" },
                { type: "king", color: "black" },
                { type: "bishop", color: "black" },
                { type: "knight", color: "black" },
                { type: "rook", color: "black" }
            ];
            for (let i = 0; i < 8; i++) board[1][i] = { type: "pawn", color: "black" };

            return board;
        }

        function isValidMove(board, fromRow, fromCol, toRow, toCol) {
            const piece = board[fromRow][fromCol];
            if (!piece) return false;

            const targetPiece = board[toRow][toCol];
            if (targetPiece?.color === piece.color) return false;

            const rowDiff = toRow - fromRow;
            const colDiff = toCol - fromCol;
            const absRowDiff = Math.abs(rowDiff);
            const absColDiff = Math.abs(colDiff);

            switch (piece.type) {
                case "pawn":
                    const direction = piece.color === "white" ? -1 : 1;
                    const startRow = piece.color === "white" ? 6 : 1;

                    if (colDiff === 0) {
                        if (rowDiff === direction && !targetPiece) return true;
                        if (fromRow === startRow && rowDiff === 2 * direction && !targetPiece && !board[fromRow + direction][fromCol])
                            return true;
                    } else if (absColDiff === 1 && rowDiff === direction) {
                        return !!targetPiece;
                    }
                    return false;

                case "rook":
                    if (rowDiff !== 0 && colDiff !== 0) return false;
                    break;

                case "knight":
                    return (absRowDiff === 2 && absColDiff === 1) || (absRowDiff === 1 && absColDiff === 2);

                case "bishop":
                    if (absRowDiff !== absColDiff) return false;
                    break;

                case "queen":
                    if (rowDiff !== 0 && colDiff !== 0 && absRowDiff !== absColDiff) return false;
                    break;

                case "king":
                    return absRowDiff <= 1 && absColDiff <= 1;
            }

            // Check path for sliding pieces
            if (piece.type === "rook" || piece.type === "bishop" || piece.type === "queen") {
                const stepRow = rowDiff === 0 ? 0 : rowDiff > 0 ? 1 : -1;
                const stepCol = colDiff === 0 ? 0 : colDiff > 0 ? 1 : -1;
                let checkRow = fromRow + stepRow;
                let checkCol = fromCol + stepCol;

                while (checkRow !== toRow || checkCol !== toCol) {
                    if (board[checkRow][checkCol]) return false;
                    checkRow += stepRow;
                    checkCol += stepCol;
                }
            }

            return true;
        }

        function getValidMoves(board, row, col) {
            const piece = board[row][col];
            if (!piece) return [];

            const moves = [];
            for (let toRow = 0; toRow < 8; toRow++) {
                for (let toCol = 0; toCol < 8; toCol++) {
                    if (isValidMove(board, row, col, toRow, toCol)) {
                        const testBoard = board.map(r => [...r]);
                        testBoard[toRow][toCol] = testBoard[row][col];
                        testBoard[row][col] = null;
                        moves.push([toRow, toCol]);
                    }
                }
            }
            return moves;
        }

        function renderBoard() {
            const boardElement = document.getElementById('chessBoard');
            boardElement.innerHTML = '';
            
            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const displayRow = isFlipped ? 7 - row : row;
                    const displayCol = isFlipped ? 7 - col : col;
                    
                    const piece = board[displayRow][displayCol];
                    const isLight = (displayRow + displayCol) % 2 === 0;
                    const isSelected = selectedSquare && selectedSquare[0] === displayRow && selectedSquare[1] === displayCol;
                    const isValidMove = validMoves.some(([r, c]) => r === displayRow && c === displayCol);

                    const square = document.createElement('div');
                    square.className = 'chess-square';
                    square.style.backgroundColor = isLight ? themes[currentTheme].light : themes[currentTheme].dark;
                    if (isSelected) square.style.backgroundColor = '#fbbf24';
                    
                    square.onclick = () => handleSquareClick(displayRow, displayCol);

                    if (piece) {
                        const pieceElement = document.createElement('span');
                        pieceElement.className = 'chess-piece';
                        pieceElement.textContent = PIECE_SYMBOLS[piece.color][piece.type];
                        pieceElement.style.color = piece.color === 'white' ? 'white' : 'black';
                        pieceElement.style.textShadow = piece.color === 'white' 
                            ? '0 0 2px rgba(0,0,0,1)' 
                            : '0 0 2px rgba(255,255,255,0.8)';
                        square.appendChild(pieceElement);
                    }

                    if (isValidMove) {
                        const moveIndicator = document.createElement('div');
                        moveIndicator.className = 'valid-move';
                        square.appendChild(moveIndicator);
                    }

                    boardElement.appendChild(square);
                }
            }
        }

        function handleSquareClick(row, col) {
            if (promotionSquare) return;

            const piece = board[row][col];
            
            if (selectedSquare) {
                const [fromRow, fromCol] = selectedSquare;
                const movingPiece = board[fromRow][fromCol];

                if (movingPiece) {
                    const canMove = validMoves.some(([r, c]) => r === row && c === col);

                    if (canMove) {
                        const newBoard = board.map(r => [...r]);
                        newBoard[row][col] = movingPiece;
                        newBoard[fromRow][fromCol] = null;

                        // Check for pawn promotion
                        if (movingPiece.type === "pawn" && (row === 0 || row === 7)) {
                            promotionSquare = { row, col };
                            board = newBoard;
                            document.getElementById('promotionDialog').classList.remove('hidden');
                            selectedSquare = null;
                            validMoves = [];
                            renderBoard();
                            return;
                        }

                        board = newBoard;
                        currentPlayer = currentPlayer === "white" ? "black" : "white";
                        selectedSquare = null;
                        validMoves = [];
                        updateGameStatus();
                        renderBoard();
                        
                        // Play move sound
                        if (soundEnabled) {
                            playMoveSound();
                        }
                        return;
                    }
                }
            }

            if (piece && piece.color === currentPlayer) {
                selectedSquare = [row, col];
                validMoves = getValidMoves(board, row, col);
            } else {
                selectedSquare = null;
                validMoves = [];
            }
            
            renderBoard();
        }

        function promotePiece(pieceType) {
            if (!promotionSquare) return;

            const { row, col } = promotionSquare;
            const promotingPiece = board[row][col];

            if (promotingPiece) {
                board[row][col] = { type: pieceType, color: promotingPiece.color };
                currentPlayer = currentPlayer === "white" ? "black" : "white";
            }

            promotionSquare = null;
            document.getElementById('promotionDialog').classList.add('hidden');
            updateGameStatus();
            renderBoard();
        }

        function resetBoard() {
            board = createInitialBoard();
            currentPlayer = 'white';
            selectedSquare = null;
            validMoves = [];
            promotionSquare = null;
            document.getElementById('promotionDialog').classList.add('hidden');
            updateGameStatus();
            renderBoard();
        }

        function flipBoard() {
            isFlipped = !isFlipped;
            renderBoard();
        }

        function goBackToLobby() {
            // This would navigate back to the lobby in a real app
            alert('Back to Lobby clicked! In a real app, this would navigate to the lobby.');
        }

        function updateGameStatus() {
            const statusElement = document.getElementById('gameStatus');
            const statusCard = document.getElementById('gameStatusCard');
            const statusMobile = document.getElementById('gameStatusMobile');
            const status = `${currentPlayer === 'white' ? 'White' : 'Black'} to move`;
            statusElement.textContent = status;
            statusCard.textContent = status;
            statusMobile.textContent = status;
        }

        // Timer functions
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function updateTimerDisplay() {
            document.getElementById('whiteTime').textContent = formatTime(whiteTime);
            document.getElementById('blackTime').textContent = formatTime(blackTime);
            document.getElementById('whiteTimeDesktop').textContent = formatTime(whiteTime);
            document.getElementById('blackTimeDesktop').textContent = formatTime(blackTime);
        }

        function startTimer() {
            if (!isTimerRunning) {
                isTimerRunning = true;
                timerInterval = setInterval(() => {
                    if (currentPlayer === 'white') {
                        whiteTime--;
                    } else {
                        blackTime--;
                    }
                    updateTimerDisplay();
                    
                    if (whiteTime <= 0 || blackTime <= 0) {
                        clearInterval(timerInterval);
                        isTimerRunning = false;
                        alert(`${currentPlayer === 'white' ? 'Black' : 'White'} wins on time!`);
                    }
                }, 1000);
            }
        }

        function pauseTimer() {
            if (isTimerRunning) {
                clearInterval(timerInterval);
                isTimerRunning = false;
            }
        }

        function resetTimer() {
            clearInterval(timerInterval);
            isTimerRunning = false;
            whiteTime = timeControl * 60;
            blackTime = timeControl * 60;
            updateTimerDisplay();
        }

        function setTimeControl(minutes) {
            timeControl = minutes;
            resetTimer();
        }

        // Theme functions
        function setTheme(theme) {
            currentTheme = theme;
            renderBoard();
        }

        // Sound functions
        function initAudioContext() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playMoveSound() {
            if (!soundEnabled) return;
            
            initAudioContext();
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            const button = document.getElementById('soundToggle');
            const buttonMobile = document.getElementById('soundToggleMobile');
            const text = soundEnabled ? 'Sound: ON' : 'Sound: OFF';
            const bgColor = soundEnabled ? 'bg-green-600' : 'bg-red-600';
            const hoverColor = soundEnabled ? 'hover:bg-green-700' : 'hover:bg-red-700';
            
            button.textContent = text;
            button.className = `w-full px-4 py-2 ${bgColor} text-white rounded ${hoverColor} text-sm`;
            
            buttonMobile.textContent = text;
            buttonMobile.className = `px-4 py-2 ${bgColor} text-white rounded ${hoverColor} text-sm`;
        }

        // Initialize the game
        board = createInitialBoard();
        renderBoard();
        updateTimerDisplay();
    </script>
</body>
</html>
